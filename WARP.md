# WARP.md

This file provides guidance to WARP (warp.dev) when working with code in this repository.

## Commands

### Install
- Install dependencies:
  - `npm install`
  - (lockfile-clean install) `npm ci`

### Local development
- Start the dev server (Vite + Cloudflare integration): `npm run dev`
- Production build (TypeScript project build + Vite bundling): `npm run build`
- Preview the production build locally: `npm run preview`

### Lint
- Run ESLint (flat config): `npm run lint`

### Cloudflare Workers / deploy
- Deploy (build + `wrangler deploy`): `npm run deploy`
- Regenerate Cloudflare Worker runtime/env types (updates `worker-configuration.d.ts`): `npm run cf-typegen`

### Tests
- No test runner is currently configured (there is no `test` script in `package.json`).

## Architecture (big picture)

### Two halves: SPA frontend + Worker backend
- **Frontend (React SPA)** lives in `src/` and is bundled by Vite.
  - Entry point: `src/main.tsx` renders the app into the `#root` element in `index.html`.
  - Root component: `src/App.tsx` (currently includes a demo call to `/api/`).

- **Backend (Cloudflare Worker)** lives in `worker/`.
  - Entry point: `worker/index.ts` exports an `ExportedHandler<Env>` with a `fetch` handler.
  - Current routing: requests under `/api/` return JSON; all other paths return 404 from the Worker code.

### How requests are served in production
- `wrangler.jsonc` points `main` at `worker/index.ts` and enables SPA-friendly asset behavior:
  - `assets.not_found_handling = "single-page-application"` means unknown asset paths fall back to the SPA entry (so client-side routing works when deployed).

### Tooling and configuration that tie it together
- Vite config (`vite.config.ts`) uses:
  - `@vitejs/plugin-react` for React
  - `@cloudflare/vite-plugin` to integrate the Worker/runtime during local dev and build workflows.

- TypeScript is set up as a **project references** build (`tsconfig.json` references app/node/worker configs). The build script runs `tsc -b` before `vite build`.

- Worker environment/runtime types are generated by Wrangler into `worker-configuration.d.ts` and are included via `tsconfig.json`/`tsconfig.worker.json` types; re-run `npm run cf-typegen` after changing Wrangler bindings.

## Repo-specific workflow rules
- Do not run `git commit` unless the user explicitly asks for it; keep changes ready for review instead.